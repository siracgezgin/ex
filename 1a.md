# âš½ Angular Futbol Ligi SimÃ¼lasyonu - Angular 18 BaÅŸlangÄ±Ã§ Rehberi

## ğŸ“‹ Proje Genel BakÄ±ÅŸ

Bu proje, **futbol ligi simÃ¼lasyonu** iÃ§in geliÅŸtirilmiÅŸ bir Angular uygulamasÄ±dÄ±r. Angular 18'den baÅŸlayÄ±p 20'ye geÃ§iÅŸ yapacaÄŸÄ±z.

### ğŸ¯ Ana AmaÃ§
- **Liga baÅŸlatma** ve **takÄ±m yÃ¶netimi**
- **FikstÃ¼r oluÅŸturma** (Round Robin algoritmasÄ±)
- **MaÃ§ simÃ¼lasyonu** ve **sonuÃ§ hesaplama**
- **Puan tablosu** ve **ÅŸampiyonluk ihtimalleri**

---

## ğŸ—ï¸ Teknoloji Stack'i (Angular 18 BaÅŸlangÄ±Ã§)

```json
{
  "name": "futbol-ligi-simulasyonu",
  "version": "0.0.0",
  "scripts": {
    "ng": "ng",
    "start": "ng serve",
    "build": "ng build --configuration=production",
    "test": "ng test",
    "lint": "ng lint"
  },
  "dependencies": {
    "@angular/animations": "^18.2.4",
    "@angular/common": "^18.2.4",
    "@angular/compiler": "^18.2.4",
    "@angular/core": "^18.2.4",
    "@angular/forms": "^18.2.4",
    "@angular/platform-browser": "^18.2.4",
    "@angular/platform-browser-dynamic": "^18.2.4",
    "@angular/router": "^18.2.4",
    "@ngrx/effects": "^18.0.2",
    "@ngrx/store": "^18.0.2",
    "@ngrx/store-devtools": "^18.0.2",
    "bootstrap": "^5.3.2",
    "primeng": "^17.18.11",
    "primeicons": "^7.0.0",
    "rxjs": "^7.8.1",
    "tailwindcss": "^3.0.0",
    "tslib": "^2.6.2",
    "zone.js": "~0.14.3"
  },
  "devDependencies": {
    "@angular-devkit/build-angular": "^18.2.4",
    "@angular/cli": "~18.2.4",
    "@angular/compiler-cli": "^18.2.4",
    "@types/jasmine": "~5.1.4",
    "autoprefixer": "^10.4.21",
    "jasmine-core": "~5.1.1",
    "karma": "^6.3.0",
    "karma-chrome-launcher": "~3.2.0",
    "karma-coverage": "~2.2.1",
    "karma-jasmine": "^4.0.2",
    "karma-jasmine-html-reporter": "^1.7.0",
    "postcss": "^8.5.6",
    "typescript": "~5.5.4"
  }
}
```

---

## ğŸš€ AdÄ±m AdÄ±m Kurulum ve GeliÅŸtirme

### ğŸ”§ **1. PROJE KURULUMU (30 dakika)**

#### 1.1 Angular 18 Kurulumu
```bash
# Angular CLI 18 kurulumu
npm install -g @angular/cli@18.2.4

# Proje oluÅŸturma
ng new futbol-ligi-simulasyonu --routing --style=scss --skip-git

# Proje dizinine geÃ§iÅŸ
cd futbol-ligi-simulasyonu

# Gerekli paketlerin kurulumu
npm install @ngrx/store@18 @ngrx/effects@18 @ngrx/store-devtools@18
npm install primeng@17.18.11 primeicons@7
npm install bootstrap@5.3.2
npm install -D tailwindcss@3.0 autoprefixer@10.4.21 postcss@8.5.6

# Tailwind CSS kurulumu
npx tailwindcss init -p

# BaÅŸlatma
ng serve
```

#### 1.2 KlasÃ¶r YapÄ±sÄ±nÄ± OluÅŸturma
```bash
# Windows (PowerShell)
New-Item -ItemType Directory -Path "src\app\common\models" -Force
New-Item -ItemType Directory -Path "src\app\common\services" -Force  
New-Item -ItemType Directory -Path "src\app\store\league" -Force
New-Item -ItemType Directory -Path "src\app\league\league-dashboard" -Force
New-Item -ItemType Directory -Path "src\app\league\standings-table" -Force
New-Item -ItemType Directory -Path "src\app\league\match-results" -Force
New-Item -ItemType Directory -Path "src\assets\i18n" -Force
New-Item -ItemType Directory -Path "src\assets\styles" -Force

# Linux/Mac
mkdir -p src/app/common/models
mkdir -p src/app/common/services
mkdir -p src/app/store/league
mkdir -p src/app/league/league-dashboard
mkdir -p src/app/league/standings-table
mkdir -p src/app/league/match-results
mkdir -p src/assets/i18n
mkdir -p src/assets/styles
```

---

### ğŸ“ **2. MODEL DOSYALARINI OLUÅTURMA (45 dakika)**

#### 2.1 Team Model (src/app/common/models/team.model.ts)
```typescript
/**
 * TakÄ±m modeli - Futbol takÄ±mÄ±nÄ±n temel bilgilerini ve istatistiklerini iÃ§erir
 */
export interface ITeam {
  /** TakÄ±mÄ±n benzersiz kimlik numarasÄ± */
  id: number;
  /** TakÄ±m adÄ± */
  name: string;
  /** Oynanan maÃ§ sayÄ±sÄ± */
  played: number;
  /** KazanÄ±lan maÃ§ sayÄ±sÄ± */
  won: number;
  /** Berabere biten maÃ§ sayÄ±sÄ± */
  drawn: number;
  /** Kaybedilen maÃ§ sayÄ±sÄ± */
  lost: number;
  /** AtÄ±lan gol sayÄ±sÄ± */
  goalsFor: number;
  /** Yenilen gol sayÄ±sÄ± */
  goalsAgainst: number;
  /** Gol farkÄ± (atÄ±lan - yenilen) */
  goalDifference: number;
  /** Toplam puan (galibiyet: 3, beraberlik: 1) */
  points: number;
  /** TakÄ±m gÃ¼cÃ¼ (1-5 arasÄ± deÄŸer, simÃ¼lasyonda kullanÄ±lÄ±r) */
  strength: number;
}

/**
 * TakÄ±m istatistikleri - TakÄ±m bilgileri ve sÄ±ralama pozisyonu
 */
export interface ITeamStats {
  /** TakÄ±m bilgileri */
  team: ITeam;
  /** Lig sÄ±ralamasÄ±ndaki pozisyonu */
  position: number;
  /** Åampiyonluk ihtimali yÃ¼zdesi (opsiyonel) */
  championshipChance?: number;
  /** Åampiyonluk ÅŸansÄ±nÄ±n olup olmadÄ±ÄŸÄ± */
  isChampionshipPossible?: boolean;
}
```

#### 2.2 Match Model (src/app/common/models/match.model.ts)
```typescript
/**
 * MaÃ§ sonucu enum'u
 */
export enum MatchResult {
  HOME_WIN = 'HOME_WIN',
  AWAY_WIN = 'AWAY_WIN',
  DRAW = 'DRAW'
}

/**
 * MaÃ§ modeli - Futbol maÃ§Ä±nÄ±n bilgilerini iÃ§erir
 */
export interface IMatch {
  /** MaÃ§Ä±n benzersiz kimlik numarasÄ± */
  id: number;
  /** Hafta numarasÄ± */
  week: number;
  /** Ev sahibi takÄ±m bilgileri */
  homeTeam: {
    id: number;
    name: string;
  };
  /** Deplasman takÄ±m bilgileri */
  awayTeam: {
    id: number;
    name: string;
  };
  /** Ev sahibi takÄ±mÄ±n gol sayÄ±sÄ± */
  homeScore: number | null;
  /** Deplasman takÄ±mÄ±n gol sayÄ±sÄ± */
  awayScore: number | null;
  /** MaÃ§Ä±n oynanÄ±p oynanmadÄ±ÄŸÄ± */
  isPlayed: boolean;
  /** MaÃ§ sonucu */
  result?: MatchResult;
}

/**
 * HaftalÄ±k maÃ§lar - Belirli bir haftadaki tÃ¼m maÃ§larÄ± iÃ§erir
 */
export interface IWeekMatches {
  /** Hafta numarasÄ± */
  week: number;
  /** O haftadaki maÃ§lar */
  matches: IMatch[];
}

/**
 * MaÃ§ dÃ¼zenleme - MaÃ§ sonucunu manuel olarak dÃ¼zenlemek iÃ§in
 */
export interface IMatchEdit {
  /** DÃ¼zenlenecek maÃ§Ä±n ID'si */
  matchId: number;
  /** Ev sahibi takÄ±mÄ±n gol sayÄ±sÄ± */
  homeScore: number;
  /** Deplasman takÄ±mÄ±n gol sayÄ±sÄ± */
  awayScore: number;
}
```

#### 2.3 League Constants (src/app/common/models/league.constants.ts)
```typescript
/**
 * Liga sabitleri - Oyun kurallarÄ± ve konfigÃ¼rasyon deÄŸerleri
 */
export const LEAGUE_CONSTANTS = {
  /** Puan sistemi */
  POINTS: {
    WIN: 3,
    DRAW: 1,
    LOSS: 0
  },
  /** TakÄ±m sayÄ±sÄ± */
  TEAM_COUNT: 4,
  /** Toplam hafta sayÄ±sÄ± (Ã§ift devreli lig) */
  TOTAL_WEEKS: 6,
  /** TakÄ±m isimleri */
  TEAM_NAMES: [
    'Galatasaray',
    'FenerbahÃ§e', 
    'BeÅŸiktaÅŸ',
    'Trabzonspor'
  ],
  /** TakÄ±m gÃ¼cÃ¼ aralÄ±ÄŸÄ± */
  TEAM_STRENGTH: {
    MIN: 1,
    MAX: 5,
    DEFAULT: 3
  }
};

/** Åampiyonluk hesaplama baÅŸlangÄ±Ã§ haftasÄ± */
export const CHAMPIONSHIP_CALCULATION_START_WEEK = 4;
```

#### 2.4 League State (src/app/common/models/league-state.model.ts)
```typescript
import { ITeam, ITeamStats } from './team.model';
import { IMatch, IWeekMatches } from './match.model';

/**
 * Liga state modeli - NgRx store iÃ§in state yapÄ±sÄ±
 */
export interface ILeagueState {
  /** TÃ¼m takÄ±mlar */
  teams: ITeam[];
  /** TÃ¼m maÃ§lar */
  matches: IMatch[];
  /** Puan tablosu */
  standings: ITeamStats[];
  /** HaftalÄ±k maÃ§lar */
  weeklyMatches: IWeekMatches[];
  /** Mevcut hafta */
  currentWeek: number;
  /** Sezonun bitip bitmediÄŸi */
  isSeasonFinished: boolean;
  /** Åampiyon takÄ±m */
  champion: ITeam | null;
  /** YÃ¼kleme durumu */
  loading: boolean;
  /** Hata mesajÄ± */
  error: string | null;
}

/**
 * BaÅŸlangÄ±Ã§ state deÄŸerleri
 */
export const initialLeagueState: ILeagueState = {
  teams: [],
  matches: [],
  standings: [],
  weeklyMatches: [],
  currentWeek: 1,
  isSeasonFinished: false,
  champion: null,
  loading: false,
  error: null
};
```

---

### ğŸ”§ **3. LIGA SIMÃœLASYON SERVÄ°SÄ° (2-3 saat)**

#### 3.1 League Simulation Service (src/app/common/services/league-simulation.service.ts)
```typescript
import { Injectable } from '@angular/core';
import { Observable, of } from 'rxjs';
import { delay } from 'rxjs/operators';
import { ITeam, IMatch, MatchResult, IMatchEdit } from '../models';
import { LEAGUE_CONSTANTS } from '../models/league.constants';

/**
 * Liga simÃ¼lasyon servisi - TakÄ±m yÃ¶netimi, fikstÃ¼r oluÅŸturma ve maÃ§ simÃ¼lasyonu
 */

@Injectable({
  providedIn: 'root'
})
export class LeagueSimulationService {
  
  /**
   * TakÄ±mlarÄ± baÅŸlatÄ±r ve rastgele gÃ¼Ã§ deÄŸerleri atar
   * @returns Observable<ITeam[]> - BaÅŸlatÄ±lan takÄ±mlar
   */
  initializeTeams(): Observable<ITeam[]> {
    const teams: ITeam[] = LEAGUE_CONSTANTS.TEAM_NAMES.map((name, index) => ({
      id: index + 1,
      name,
      played: 0,
      won: 0,
      drawn: 0,
      lost: 0,
      goalsFor: 0,
      goalsAgainst: 0,
      goalDifference: 0,
      points: 0,
      strength: this.getRandomTeamStrength()
    }));

    return of(teams).pipe(delay(500));
  }

  /**
   * Round Robin algoritmasÄ± ile fikstÃ¼r oluÅŸturur
   * @param teams - TakÄ±m listesi
   * @returns Observable<IMatch[]> - OluÅŸturulan maÃ§lar
   */
  generateFixture(teams: ITeam[]): Observable<IMatch[]> {
    const firstHalfMatches = this.generateFirstHalfMatches(teams);
    const secondHalfMatches = this.generateSecondHalfMatches(firstHalfMatches);
    
    return of([...firstHalfMatches, ...secondHalfMatches]).pipe(delay(300));
  }

  /**
   * Belirli bir haftanÄ±n maÃ§larÄ±nÄ± simÃ¼le eder
   * @param matches - TÃ¼m maÃ§lar
   * @param currentWeek - OynatÄ±lacak hafta
   * @returns Observable<IMatch[]> - GÃ¼ncellenmiÅŸ maÃ§lar
   */
  playWeekMatches(matches: IMatch[], currentWeek: number): Observable<IMatch[]> {
    const weekMatches = matches.filter(match => 
      match.week === currentWeek && !match.isPlayed
    );
    
    const updatedMatches = weekMatches.map(match => {
      const homeStrength = this.getTeamStrengthById(match.homeTeam.id);
      const awayStrength = this.getTeamStrengthById(match.awayTeam.id);
      
      const result = this.simulateMatch(
        match.homeTeam.id,
        match.awayTeam.id,
        homeStrength,
        awayStrength
      );

      return {
        ...match,
        homeScore: result.homeScore,
        awayScore: result.awayScore,
        isPlayed: true,
        result: result.result
      };
    });

    return of(updatedMatches).pipe(delay(800));
  }

  // TÃ¼m sezon oynatma
  playAllRemainingSeason(matches: Match[], currentWeek: number): Observable<Match[]> {
    const unplayedMatches = matches.filter(match => 
      match.week >= currentWeek && !match.isPlayed
    );
    
    const updatedMatches = unplayedMatches.map(match => {
      const homeStrength = this.getTeamStrengthById(match.homeTeam.id);
      const awayStrength = this.getTeamStrengthById(match.awayTeam.id);
      
      const result = this.simulateMatch(
        match.homeTeam.id,
        match.awayTeam.id,
        homeStrength,
        awayStrength
      );

      return {
        ...match,
        homeScore: result.homeScore,
        awayScore: result.awayScore,
        isPlayed: true,
        result: result.result
      };
    });

    return of(updatedMatches).pipe(delay(1500));
  }

  // MaÃ§ sonucu dÃ¼zenleme
  editMatchResult(matches: Match[], matchId: number, homeScore: number, awayScore: number): Observable<Match[]> {
    const updatedMatches = matches.map(match => {
      if (match.id === matchId) {
        return {
          ...match,
          homeScore,
          awayScore,
          isPlayed: true,
          result: this.determineResult(homeScore, awayScore)
        };
      }
      return match;
    });

    return of(updatedMatches).pipe(delay(300));
  }

  // Åampiyonluk ihtimallerini hesaplama (Monte Carlo)
  calculateChampionshipChances(teams: Team[], remainingMatches: Match[]): Observable<{ [teamId: number]: number }> {
    if (remainingMatches.length === 0) {
      return of({});
    }

    const simulations = 1000;
    const championshipCounts: { [teamId: number]: number } = {};
    
    // Her takÄ±m iÃ§in sayaÃ§ baÅŸlat
    teams.forEach(team => {
      championshipCounts[team.id] = 0;
    });

    // Monte Carlo simÃ¼lasyonu
    for (let i = 0; i < simulations; i++) {
      const simulatedMatches = this.simulateRemainingMatches(remainingMatches);
      const finalStandings = this.calculateFinalStandings(teams, simulatedMatches);
      const champion = finalStandings[0];
      
      if (champion) {
        championshipCounts[champion.team.id]++;
      }
    }

    // YÃ¼zdelere Ã§evir
    const chances: { [teamId: number]: number } = {};
    teams.forEach(team => {
      chances[team.id] = (championshipCounts[team.id] / simulations) * 100;
    });

    return of(chances).pipe(delay(500));
  }

  // YardÄ±mcÄ± metodlar
  private getRandomTeamStrength(): number {
    const min = LEAGUE_CONSTANTS.TEAM_STRENGTH.MIN;
    const max = LEAGUE_CONSTANTS.TEAM_STRENGTH.MAX;
    return Math.floor(Math.random() * (max - min + 1)) + min;
  }

  private getTeamStrengthById(teamId: number): number {
    // GerÃ§ek uygulamada teams array'inden alÄ±nÄ±r
    return Math.floor(Math.random() * 5) + 1;
  }

  private simulateMatch(homeTeamId: number, awayTeamId: number, homeStrength: number, awayStrength: number) {
    // Ev sahibi avantajÄ± (%30)
    const homeAdvantage = 0.3;
    const adjustedHomeStrength = homeStrength + homeAdvantage;
    
    const homeScore = this.generateGoalCount(adjustedHomeStrength);
    const awayScore = this.generateGoalCount(awayStrength);
    
    return {
      homeScore,
      awayScore,
      result: this.determineResult(homeScore, awayScore)
    };
  }

  private generateGoalCount(strength: number): number {
    // TakÄ±m gÃ¼cÃ¼ne gÃ¶re gol sayÄ±sÄ± hesaplama
    const baseChance = strength / 5;
    const random = Math.random();
    
    if (random < 0.1) return 0; // %10 ÅŸansla 0 gol
    if (random < 0.3 + (baseChance * 0.2)) return 1; // GÃ¼ce gÃ¶re 1 gol
    if (random < 0.7 + (baseChance * 0.15)) return 2; // 2 gol
    if (random < 0.9 + (baseChance * 0.1)) return 3; // 3 gol
    if (random < 0.98) return 4; // Nadir 4 gol
    return 5; // Ã‡ok nadir 5 gol
  }

  private determineResult(homeScore: number, awayScore: number): MatchResult {
    if (homeScore > awayScore) return MatchResult.HOME_WIN;
    if (awayScore > homeScore) return MatchResult.AWAY_WIN;
    return MatchResult.DRAW;
  }

  private generateFirstHalfMatches(teams: Team[]): Match[] {
    return this.generateRoundRobinFixtures(teams, 1, 1);
  }

  private generateSecondHalfMatches(firstHalfMatches: Match[]): Match[] {
    const numTeams = LEAGUE_CONSTANTS.TEAM_COUNT;
    const secondHalfStartWeek = numTeams - 1 + 1;
    const secondHalfStartMatchId = firstHalfMatches.length + 1;
    
    // Ä°kinci yarÄ±da ev sahibi deÄŸiÅŸir
    return firstHalfMatches.map((match, index) => ({
      id: secondHalfStartMatchId + index,
      week: match.week + (numTeams - 1),
      homeTeam: match.awayTeam, // Ev sahibi deÄŸiÅŸir
      awayTeam: match.homeTeam,
      homeScore: null,
      awayScore: null,
      isPlayed: false
    }));
  }

  private shuffleTeams(teams: Team[]): Team[] {
    const shuffled = [...teams];
    for (let i = shuffled.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
    }
    return shuffled;
  }

  private shuffleArray<T>(array: T[]): T[] {
    const shuffled = [...array];
    for (let i = shuffled.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
    }
    return shuffled;
  }

  private generateRoundRobinFixtures(teams: Team[], startWeek: number, startMatchId: number): Match[] {
    const matches: Match[] = [];
    const numTeams = teams.length;
    let matchId = startMatchId;
    
    const shuffledTeams = this.shuffleTeams([...teams]);
    const totalWeeks = numTeams - 1; // N-1 hafta
    const matchesPerWeek = numTeams / 2; // Her hafta N/2 maÃ§

    for (let week = 0; week < totalWeeks; week++) {
      const weekNumber = startWeek + week;

      // Bu haftanÄ±n maÃ§larÄ±nÄ± oluÅŸtur
      for (let i = 0; i < matchesPerWeek; i++) {
        const homeTeam = shuffledTeams[i];
        const awayTeam = shuffledTeams[numTeams - 1 - i];

        matches.push({
          id: matchId++,
          week: weekNumber,
          homeTeam: { id: homeTeam.id, name: homeTeam.name },
          awayTeam: { id: awayTeam.id, name: awayTeam.name },
          homeScore: null,
          awayScore: null,
          isPlayed: false
        });
      }
      
      // Son hafta deÄŸilse takÄ±mlarÄ± dÃ¶ndÃ¼r
      if (week < totalWeeks - 1) {
        this.rotateTeams(shuffledTeams);
      }
    }
    
    return matches;
  }

  private rotateTeams(teams: Team[]): void {
    // Ä°lk takÄ±mÄ± sabit tut, diÄŸerlerini dÃ¶ndÃ¼r
    if (teams.length > 2) {
      const fixed = teams[0];
      const rotating = teams.slice(1);
      const last = rotating.pop();
      if (last) {
        rotating.unshift(last);
      }
      teams.splice(0, teams.length, fixed, ...rotating);
    }
  }

  private simulateRemainingMatches(matches: Match[]): Match[] {
    return matches.map(match => {
      const homeStrength = this.getTeamStrengthById(match.homeTeam.id);
      const awayStrength = this.getTeamStrengthById(match.awayTeam.id);
      
      const result = this.simulateMatch(
        match.homeTeam.id,
        match.awayTeam.id,
        homeStrength,
        awayStrength
      );

      return {
        ...match,
        homeScore: result.homeScore,
        awayScore: result.awayScore,
        isPlayed: true,
        result: result.result
      };
    });
  }

  private calculateFinalStandings(teams: Team[], simulatedMatches: Match[]): any[] {
    // Basit sÄ±ralama hesaplama - gerÃ§ek uygulamada daha karmaÅŸÄ±k
    return teams.map(team => ({ team })).sort(() => Math.random() - 0.5);
  }
}
```

---

### ğŸª **4. NGRX STATE MANAGEMENT (2-3 saat)**

#### 4.1 Actions (src/app/store/league/league.actions.ts)
```typescript
import { createAction, props } from '@ngrx/store';
import { ITeam, IMatch, IMatchEdit } from '../../common/models';

/**
 * Liga baÅŸlatma action'larÄ±
 */

// Liga baÅŸlatma
export const initializeLeague = createAction(
  '[League] Initialize League'
);

export const initializeLeagueSuccess = createAction(
  '[League] Initialize League Success',
  props<{ teams: ITeam[]; matches: IMatch[] }>()
);

export const initializeLeagueFailure = createAction(
  '[League] Initialize League Failure',
  props<{ error: string }>()
);

// Sonraki hafta
export const playNextWeek = createAction(
  '[League] Play Next Week'
);

export const playNextWeekSuccess = createAction(
  '[League] Play Next Week Success',
  props<{ matches: IMatch[]; currentWeek: number }>()
);

export const playNextWeekFailure = createAction(
  '[League] Play Next Week Failure',
  props<{ error: string }>()
);

// TÃ¼m sezon
export const playAllSeason = createAction(
  '[League] Play All Season'
);

export const playAllSeasonSuccess = createAction(
  '[League] Play All Season Success',
  props<{ matches: IMatch[]; currentWeek: number }>()
);

export const playAllSeasonFailure = createAction(
  '[League] Play All Season Failure',
  props<{ error: string }>()
);

// MaÃ§ dÃ¼zenleme
export const editMatchResult = createAction(
  '[League] Edit Match Result',
  props<{ matchEdit: IMatchEdit }>()
);

export const editMatchResultSuccess = createAction(
  '[League] Edit Match Result Success',
  props<{ matches: IMatch[] }>()
);

export const editMatchResultFailure = createAction(
  '[League] Edit Match Result Failure',
  props<{ error: string }>()
);

// SÄ±ralama hesaplama
export const calculateStandings = createAction(
  '[League] Calculate Standings'
);

export const calculateStandingsSuccess = createAction(
  '[League] Calculate Standings Success'
);

// Liga sÄ±fÄ±rlama
export const resetLeague = createAction(
  '[League] Reset League'
);

// Loading ve Error
export const setLoading = createAction(
  '[League] Set Loading',
  props<{ loading: boolean }>()
);

export const setError = createAction(
  '[League] Set Error',
  props<{ error: string }>()
);

export const clearError = createAction(
  '[League] Clear Error'
);
```

#### 4.2 Reducer (src/app/store/league/league.reducer.ts)
```typescript
import { createReducer, on } from '@ngrx/store';
import { ILeagueState, initialLeagueState } from '../../common/models/league-state.model';
import { LEAGUE_CONSTANTS } from '../../common/models/league.constants';
import * as LeagueActions from './league.actions';

/**
 * Liga reducer - State deÄŸiÅŸikliklerini yÃ¶netir
 */

export const leagueReducer = createReducer(
  initialLeagueState,
  
  // Liga baÅŸlatma
  on(LeagueActions.initializeLeague, (state) => ({
    ...state,
    loading: true,
    error: null
  })),
  
  on(LeagueActions.initializeLeagueSuccess, (state, { teams, matches }) => ({
    ...state,
    teams,
    matches,
    standings: calculateStandings(teams, matches),
    weeklyMatches: groupMatchesByWeek(matches),
    loading: false,
    error: null,
    currentWeek: 1,
    isSeasonFinished: false,
    champion: null
  })),
  
  on(LeagueActions.initializeLeagueFailure, (state, { error }) => ({
    ...state,
    loading: false,
    error
  })),
  
  // Sonraki hafta
  on(LeagueActions.playNextWeek, (state) => ({
    ...state,
    loading: true,
    error: null
  })),
  
  on(LeagueActions.playNextWeekSuccess, (state, { matches, currentWeek }) => {
    const updatedMatches = state.matches.map(match => {
      const updatedMatch = matches.find(m => m.id === match.id);
      return updatedMatch || match;
    });
    
    const updatedTeams = updateTeamsFromMatches(state.teams, updatedMatches);
    const updatedStandings = calculateStandings(updatedTeams, updatedMatches);
    const champion = currentWeek > LEAGUE_CONSTANTS.TOTAL_WEEKS ? 
      updatedStandings[0]?.team : null;
    
    return {
      ...state,
      matches: updatedMatches,
      teams: updatedTeams,
      standings: updatedStandings,
      weeklyMatches: groupMatchesByWeek(updatedMatches),
      currentWeek,
      isSeasonFinished: currentWeek > LEAGUE_CONSTANTS.TOTAL_WEEKS,
      champion,
      loading: false
    };
  }),
  
  on(LeagueActions.playNextWeekFailure, (state, { error }) => ({
    ...state,
    loading: false,
    error
  })),
  
  // TÃ¼m sezon
  on(LeagueActions.playAllSeason, (state) => ({
    ...state,
    loading: true,
    error: null
  })),
  
  on(LeagueActions.playAllSeasonSuccess, (state, { matches, currentWeek }) => {
    const updatedMatches = state.matches.map(match => {
      const updatedMatch = matches.find(m => m.id === match.id);
      return updatedMatch || match;
    });
    
    const updatedTeams = updateTeamsFromMatches(state.teams, updatedMatches);
    const updatedStandings = calculateStandings(updatedTeams, updatedMatches);
    const champion = updatedStandings[0]?.team || null;
    
    return {
      ...state,
      matches: updatedMatches,
      teams: updatedTeams,
      standings: updatedStandings,
      weeklyMatches: groupMatchesByWeek(updatedMatches),
      currentWeek: LEAGUE_CONSTANTS.TOTAL_WEEKS + 1,
      isSeasonFinished: true,
      champion,
      loading: false
    };
  }),
  
  on(LeagueActions.playAllSeasonFailure, (state, { error }) => ({
    ...state,
    loading: false,
    error
  })),
  
  // MaÃ§ dÃ¼zenleme
  on(LeagueActions.editMatchResult, (state) => ({
    ...state,
    loading: true,
    error: null
  })),
  
  on(LeagueActions.editMatchResultSuccess, (state, { matches }) => {
    const updatedMatches = state.matches.map(match => {
      const updatedMatch = matches.find(m => m.id === match.id);
      return updatedMatch || match;
    });
    
    const updatedTeams = updateTeamsFromMatches(state.teams, updatedMatches);
    const updatedStandings = calculateStandings(updatedTeams, updatedMatches);
    
    return {
      ...state,
      matches: updatedMatches,
      teams: updatedTeams,
      standings: updatedStandings,
      weeklyMatches: groupMatchesByWeek(updatedMatches),
      loading: false
    };
  }),
  
  on(LeagueActions.editMatchResultFailure, (state, { error }) => ({
    ...state,
    loading: false,
    error
  })),
  
  // Liga sÄ±fÄ±rlama
  on(LeagueActions.resetLeague, () => initialLeagueState),
  
  // Loading ve Error
  on(LeagueActions.setLoading, (state, { loading }) => ({
    ...state,
    loading
  })),
  
  on(LeagueActions.setError, (state, { error }) => ({
    ...state,
    error,
    loading: false
  })),
  
  on(LeagueActions.clearError, (state) => ({
    ...state,
    error: null
  }))
);

// YardÄ±mcÄ± fonksiyonlar
function calculateStandings(teams: any[], matches: any[]): any[] {
  // Puan tablosu hesaplama mantÄ±ÄŸÄ±
  const standings = teams.map(team => {
    const teamMatches = matches.filter(match => 
      (match.homeTeam.id === team.id || match.awayTeam.id === team.id) && match.isPlayed
    );
    
    let points = 0;
    let won = 0;
    let drawn = 0;
    let lost = 0;
    let goalsFor = 0;
    let goalsAgainst = 0;
    
    teamMatches.forEach(match => {
      if (match.homeTeam.id === team.id) {
        goalsFor += match.homeScore || 0;
        goalsAgainst += match.awayScore || 0;
        
        if ((match.homeScore || 0) > (match.awayScore || 0)) {
          points += LEAGUE_CONSTANTS.POINTS.WIN;
          won++;
        } else if ((match.homeScore || 0) === (match.awayScore || 0)) {
          points += LEAGUE_CONSTANTS.POINTS.DRAW;
          drawn++;
        } else {
          lost++;
        }
      } else {
        goalsFor += match.awayScore || 0;
        goalsAgainst += match.homeScore || 0;
        
        if ((match.awayScore || 0) > (match.homeScore || 0)) {
          points += LEAGUE_CONSTANTS.POINTS.WIN;
          won++;
        } else if ((match.awayScore || 0) === (match.homeScore || 0)) {
          points += LEAGUE_CONSTANTS.POINTS.DRAW;
          drawn++;
        } else {
          lost++;
        }
      }
    });
    
    return {
      team: {
        ...team,
        played: teamMatches.length,
        won,
        drawn,
        lost,
        goalsFor,
        goalsAgainst,
        goalDifference: goalsFor - goalsAgainst,
        points
      },
      position: 0,
      championshipChance: 0,
      isChampionshipPossible: true
    };
  });
  
  // SÄ±ralama: puan, averaj, atÄ±lan gol
  standings.sort((a, b) => {
    if (b.team.points !== a.team.points) {
      return b.team.points - a.team.points;
    }
    if (b.team.goalDifference !== a.team.goalDifference) {
      return b.team.goalDifference - a.team.goalDifference;
    }
    return b.team.goalsFor - a.team.goalsFor;
  });
  
  // PozisyonlarÄ± gÃ¼ncelle
  standings.forEach((standing, index) => {
    standing.position = index + 1;
  });
  
  return standings;
}

function updateTeamsFromMatches(teams: any[], matches: any[]): any[] {
  return teams.map(team => {
    const teamMatches = matches.filter(match => 
      (match.homeTeam.id === team.id || match.awayTeam.id === team.id) && match.isPlayed
    );
    
    let points = 0;
    let won = 0;
    let drawn = 0;
    let lost = 0;
    let goalsFor = 0;
    let goalsAgainst = 0;
    
    teamMatches.forEach(match => {
      if (match.homeTeam.id === team.id) {
        goalsFor += match.homeScore || 0;
        goalsAgainst += match.awayScore || 0;
        
        if ((match.homeScore || 0) > (match.awayScore || 0)) {
          points += LEAGUE_CONSTANTS.POINTS.WIN;
          won++;
        } else if ((match.homeScore || 0) === (match.awayScore || 0)) {
          points += LEAGUE_CONSTANTS.POINTS.DRAW;
          drawn++;
        } else {
          lost++;
        }
      } else {
        goalsFor += match.awayScore || 0;
        goalsAgainst += match.homeScore || 0;
        
        if ((match.awayScore || 0) > (match.homeScore || 0)) {
          points += LEAGUE_CONSTANTS.POINTS.WIN;
          won++;
        } else if ((match.awayScore || 0) === (match.homeScore || 0)) {
          points += LEAGUE_CONSTANTS.POINTS.DRAW;
          drawn++;
        } else {
          lost++;
        }
      }
    });
    
    return {
      ...team,
      played: teamMatches.length,
      won,
      drawn,
      lost,
      goalsFor,
      goalsAgainst,
      goalDifference: goalsFor - goalsAgainst,
      points
    };
  });
}

function groupMatchesByWeek(matches: any[]): any[] {
  const grouped: { [week: number]: any[] } = {};
  
  matches.forEach(match => {
    if (!grouped[match.week]) {
      grouped[match.week] = [];
    }
    grouped[match.week].push(match);
  });
  
  return Object.keys(grouped).map(week => ({
    week: parseInt(week),
    matches: grouped[parseInt(week)]
  }));
}
```

---

### ğŸš€ **5. ANGULAR 20'YE GEÃ‡Ä°Å (1-2 gÃ¼n)**

#### 5.1 GÃ¼ncelleme KomutlarÄ±
```bash
# Angular 20'ye gÃ¼ncelleme
ng update @angular/core@20 @angular/cli@20

# NgRx 20'ye gÃ¼ncelleme  
ng update @ngrx/store@20 @ngrx/effects@20

# PrimeNG 19'a gÃ¼ncelleme
npm install primeng@19

# TypeScript gÃ¼ncelleme
npm install typescript@5.8.3

# Package.json kontrol
npm outdated
```

#### 5.2 Signals KullanÄ±mÄ± (Angular 20)
```typescript
// src/app/league/league-dashboard/league-dashboard.component.ts (Angular 20 versiyonu)
import { Component, OnInit, signal, computed, effect } from '@angular/core';
import { Store } from '@ngrx/store';
import * as LeagueActions from '../../store/league/league.actions';
import * as LeagueSelectors from '../../store/league/league.selectors';

@Component({
  selector: 'app-league-dashboard',
  templateUrl: './league-dashboard.component.html',
  styleUrls: ['./league-dashboard.component.scss']
})
export class LeagueDashboardComponent implements OnInit {
  
  // Signals (Angular 20)
  standings = signal<ITeamStats[]>([]);
  currentWeek = signal(1);
  loading = signal(false);
  error = signal<string | null>(null);
  
  // Computed values
  isSeasonFinished = computed(() => this.currentWeek() > 6);
  champion = computed(() => {
    const standings = this.standings();
    return standings.length > 0 ? standings[0].team : null;
  });
  
  // Store observables (NgRx ile birlikte kullanÄ±m)
  standings$ = this.store.select(LeagueSelectors.selectStandings);
  loading$ = this.store.select(LeagueSelectors.selectLoading);
  error$ = this.store.select(LeagueSelectors.selectError);

  constructor(private store: Store) {
    // Effect - signal deÄŸiÅŸikliklerini izle
    effect(() => {
      console.log('Current week changed:', this.currentWeek());
      console.log('Season finished:', this.isSeasonFinished());
    });
  }

  ngOnInit() {
    // Store'dan signals'a data aktarÄ±mÄ±
    this.standings$.subscribe(standings => {
      this.standings.set(standings);
    });
    
    this.loading$.subscribe(loading => {
      this.loading.set(loading);
    });
    
    this.error$.subscribe(error => {
      this.error.set(error);
    });
    
    // Liga baÅŸlat
    this.store.dispatch(LeagueActions.initializeLeague());
  }

  // Signal updates
  playNextWeek() {
    this.currentWeek.update(week => week + 1);
    this.store.dispatch(LeagueActions.playNextWeek());
  }

  playAllSeason() {
    this.currentWeek.set(7); // Sezon bitir
    this.store.dispatch(LeagueActions.playAllSeason());
  }

  resetLeague() {
    this.currentWeek.set(1);
    this.standings.set([]);
    this.error.set(null);
    this.store.dispatch(LeagueActions.resetLeague());
  }

  clearError() {
    this.error.set(null);
    this.store.dispatch(LeagueActions.clearError());
  }
}
```

#### 5.3 Control Flow (Angular 20)
```html
<!-- src/app/league/league-dashboard/league-dashboard.component.html (Angular 20) -->
<div class="league-dashboard">
  <!-- Angular 20 Control Flow -->
  @if (loading()) {
    <div class="loading-spinner">
      <p-progressBar mode="indeterminate"></p-progressBar>
      <p>Loading...</p>
    </div>
  } @else if (error()) {
    <div class="error-message">
      <p-message severity="error" [text]="error()"></p-message>
      <button pButton type="button" label="HatayÄ± Temizle" 
              (click)="clearError()"></button>
    </div>
  } @else {
    <!-- Liga iÃ§eriÄŸi -->
    <div class="league-content">
      
      <!-- Liga kontrolleri -->
      <div class="league-controls">
        @if (!isSeasonFinished()) {
          <button pButton type="button" 
                  label="Sonraki HaftayÄ± Oynat ({{ currentWeek() }})"
                  (click)="playNextWeek()"
                  [disabled]="loading()">
          </button>
          
          <button pButton type="button" 
                  label="TÃ¼m Sezonu Oynat"
                  (click)="playAllSeason()"
                  [disabled]="loading()">
          </button>
        }
        
        <button pButton type="button" 
                label="LigayÄ± SÄ±fÄ±rla"
                (click)="resetLeague()"
                [disabled]="loading()">
        </button>
      </div>

      <!-- Puan Tablosu -->
      <div class="standings-container">
        <h3>Puan Tablosu</h3>
        @if (standings().length > 0) {
          <div class="standings-table">
            @for (standing of standings(); track standing.team.id) {
              <div class="team-row" 
                   [class]="'team-' + standing.team.name.toLowerCase()">
                <span class="position">{{ standing.position }}</span>
                <span class="team-name">{{ standing.team.name }}</span>
                <span class="points">{{ standing.team.points }} puan</span>
                <span class="matches">{{ standing.team.played }} maÃ§</span>
                <span class="goal-diff">{{ standing.team.goalDifference > 0 ? '+' : '' }}{{ standing.team.goalDifference }}</span>
              </div>
            }
          </div>
        } @else {
          <p>HenÃ¼z maÃ§ oynanmadÄ±.</p>
        }
      </div>

      <!-- Åampiyon kutlamasÄ± -->
      @if (isSeasonFinished() && champion()) {
        <div class="champion-announcement">
          <div class="champion-card">
            <h1>ğŸ† ÅAMPÄ°YON: {{ champion()?.name }}</h1>
            <p>Tebrikler! {{ champion()?.name }} ÅŸampiyon oldu!</p>
          </div>
        </div>
      }
      
    </div>
  }
</div>
```

---

## ğŸ¯ **ANGULAR 18 vs 20 KARÅILAÅTIRMASI**

### Template Syntax
```html
<!-- Angular 18 -->
<div *ngIf="loading$ | async">Loading...</div>
<div *ngFor="let item of items$ | async">{{ item.name }}</div>

<!-- Angular 20 -->
@if (loading()) {
  <div>Loading...</div>
}
@for (item of items(); track item.id) {
  <div>{{ item.name }}</div>
}
```

### State Management
```typescript
// Angular 18 - RxJS Observables
standings$ = this.store.select(selectStandings);
loading$ = this.store.select(selectLoading);

// Angular 20 - Signals
standings = signal<TeamStats[]>([]);
loading = signal(false);
isSeasonFinished = computed(() => this.currentWeek() > 6);
```

### Component Updates
```typescript
// Angular 18 - Subscription based
ngOnInit() {
  this.standings$.subscribe(standings => {
    this.currentStandings = standings;
  });
}

// Angular 20 - Signal based
ngOnInit() {
  effect(() => {
    console.log('Standings changed:', this.standings());
  });
}
```

---

## ğŸ”§ **GEREKLI PAKETLER VE KONFIGÃœRASYON**

### package.json (Angular 18)
- YukarÄ±daki JSON'Ä± kullanÄ±n

### angular.json konfigÃ¼rasyonu
```json
{
  "projects": {
    "futbol-ligi-simulasyonu": {
      "architect": {
        "build": {
          "options": {
            "styles": [
              "node_modules/bootstrap/dist/css/bootstrap.min.css",
              "node_modules/primeicons/primeicons.css",
              "node_modules/primeng/resources/themes/lara-light-indigo/theme.css",
              "node_modules/primeng/resources/primeng.min.css",
              "src/styles.scss"
            ]
          }
        }
      }
    }
  }
}
```

### tailwind.config.js
```javascript
module.exports = {
  content: [
    "./src/**/*.{html,ts}",
  ],
  theme: {
    extend: {
      colors: {
        'galatasaray': '#FF6B35',
        'fenerbahce': '#FFD700',
        'besiktas': '#000000',
        'trabzonspor': '#8B0000'
      }
    },
  },
  plugins: [],
}
```

### styles.scss
```scss
@import 'tailwindcss/base';
@import 'tailwindcss/components';
@import 'tailwindcss/utilities';

// Custom team colors
.team-galatasaray {
  background-color: #FF6B35;
  color: white;
}

.team-fenerbahce {
  background-color: #FFD700;
  color: #1e3a8a;
}

.team-besiktas {
  background-color: #000000;
  color: white;
}

.team-trabzonspor {
  background-color: #8B0000;
  color: white;
}

// Animations
@keyframes fadeIn {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}

.fade-in {
  animation: fadeIn 0.5s ease-in-out;
}
```

---

## âœ… **GELIÅTIRME SÃœRECI KONTROLÃœ**

### AdÄ±m 1 âœ… - Kurulum (30 dk)
- [ ] Angular CLI 18 kuruldu
- [ ] Proje oluÅŸturuldu  
- [ ] Paketler yÃ¼klendi
- [ ] KlasÃ¶rler oluÅŸturuldu

### AdÄ±m 2 âœ… - Modeller (45 dk)
- [ ] team.model.ts oluÅŸturuldu
- [ ] match.model.ts oluÅŸturuldu
- [ ] league.constants.ts oluÅŸturuldu
- [ ] league-state.model.ts oluÅŸturuldu

### AdÄ±m 3 âœ… - Servis (2-3 saat)
- [ ] LeagueSimulationService oluÅŸturuldu
- [ ] Round Robin algoritmasÄ± yazÄ±ldÄ±
- [ ] MaÃ§ simÃ¼lasyonu implementasyonu
- [ ] Monte Carlo hesaplamasÄ±

### AdÄ±m 4 âœ… - NgRx (2-3 saat)
- [ ] Actions tanÄ±mlandÄ±
- [ ] Reducer yazÄ±ldÄ±
- [ ] Effects oluÅŸturuldu
- [ ] Selectors hazÄ±rlandÄ±

### AdÄ±m 5 âœ… - Angular 20 GeÃ§iÅŸ (1-2 gÃ¼n)
- [ ] Angular 20'ye gÃ¼ncelleme
- [ ] Signals implementasyonu
- [ ] Control Flow syntax
- [ ] KarÅŸÄ±laÅŸtÄ±rmalÄ± test

---

## ğŸ‰ **SONUÃ‡**

Bu rehber ile:
1. **Angular 18** ile baÅŸlayÄ±p temel kavramlarÄ± Ã¶ÄŸreneceksiniz
2. **NgRx state management** ile modern state yÃ¶netimi
3. **Angular 20** ile yeni Ã¶zellikleri deneyimleyeceksiniz
4. **KarÅŸÄ±laÅŸtÄ±rmalÄ± Ã¶ÄŸrenme** ile farklarÄ± gÃ¶receksiniz

**Kopya-yapÄ±ÅŸtÄ±r kod Ã¶rnekleri** ile hÄ±zlÄ± geliÅŸtirme yapabilir, her adÄ±mda neyin neden yazÄ±ldÄ±ÄŸÄ±nÄ± anlayabilirsiniz.

**Ä°yi kodlamalar! âš½ğŸš€**
